results_file = fopen(['../data/text_' data '_results.csv'], 'w');
angle_i = 1;

switch data
case 'shark'
  r = shark_results;
case 'tum'
  r = tum_results;
end

fprintf(results_file, ...
    ['ref_frame,src_frame,overlap,angle,'...
    'all_time,all_err,'...
    'pct_time,pct_err,'...
    'sigma_time,sigma_err,'...
    'x84_time,x84_err,'...
    'dynamic_time,dynamic_err,'...
    'goicp_time,goicp_err,'...
    's4pcs_time,s4pcs_err,'...
    'hmrf_time,hmrf_err\n']);

for angle_i=1:size(r.params, 1)
  for i=1:size(r.params, 2)
    ref_frame = r.params{angle_i,i}(1);
    src_frame = r.params{angle_i,i}(2);
    overlap = r.params{angle_i,i}(3);
    angle = r.params{angle_i,i}(4);
    all_time = r.all{angle_i,i}(2); all_err = r.all{angle_i,i}(3);
    pct_time = r.pct{angle_i,i}(2); pct_err = r.pct{angle_i,i}(3);
    sigma_time = r.sigma{angle_i,i}(2); sigma_err = r.sigma{angle_i,i}(3);
    x84_time = r.x84{angle_i,i}(2); x84_err = r.x84{angle_i,i}(3);
    dynamic_time = r.dynamic{angle_i,i}(2); dynamic_err = r.dynamic{angle_i,i}(3);
    % global methods only run for angle_i = 1, just repeat the results
    goicp_time = r.goicp{1,i}(2); goicp_err = r.goicp{1,i}(3);
    s4pcs_time = r.s4pcs{1,i}(2); s4pcs_err = r.s4pcs{1,i}(3);
    try
      hmrf_time = r.hmrf{angle_i,i}(2); hmrf_err = r.hmrf{angle_i,i}(3);
    catch ae
      hmrf_time = nan; hmrf_err = nan;
    end

    fprintf(results_file, ['%d,%d,%8.5f,%8.5f,'...
    '%8.5f,%8.5f,%8.5f,%8.5f,%8.5f,%8.5f,' ...
    '%8.5f,%8.5f,%8.5f,%8.5f,%8.5f,%8.5f,' ...
    '%8.5f,%8.5f,%8.5f,%8.5f\n'], ...
    ref_frame,src_frame,overlap,angle,...
    all_time,all_err,...
    pct_time,pct_err,...
    sigma_time,sigma_err,...
    x84_time,x84_err,...
    dynamic_time,dynamic_err,...
    goicp_time,goicp_err,...
    s4pcs_time,s4pcs_err,...
    hmrf_time,hmrf_err);
  end
end

fclose(results_file);
